(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["catalog~home"],{"234b":function(t,e,s){},3343:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"sort-by-block",class:{slideup:t.sort.show}},[i("div",{staticClass:"txt"},[i("svg",{staticClass:"mr8"},[i("use",{attrs:{"xlink:href":s("973d")+"#sort2"}})]),t._v("\n        Сортировать по:")]),i("div",{staticClass:"sort-by-list"},t._l(t.sort.order,(function(e){return i("div",{key:e.code,staticClass:"sort-item",class:[t.sortByClass,{active:t.sort.current.order===e.code}],on:{click:function(s){return t.setSort(e.code,e.name)}}},[i("a",{staticClass:"hf",attrs:{href:"javascript:void(0)"}},[i("svg",{staticClass:"icon-check"},[i("use",{attrs:{"xlink:href":s("973d")+"#check"}})]),i("span",[t._v(t._s(e.name))])])])})),0)])},o=[],a=(s("8e6e"),s("ac6a"),s("456d"),s("55dd"),s("6b54"),s("bd86")),n=s("2f62");function r(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function c(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?r(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):r(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var l={name:"CatalogSort",props:{favorites:{default:function(){return!1}},isLoad:{default:function(){return!1}}},computed:c({sortByClass:function(){return this.sort.current.by.toString()===this.sort.by.asc?"up":"down"}},Object(n["b"])({sort:function(t){return t.actions.sort},couponsCount:function(t){return t.actions.coupons.length}})),data:function(){return{isReSort:!1}},methods:{toggleMap:function(){this.$store.commit("actions/toggleMap")},setSort:function(t,e){var s=this;this.isReSort=!0,this.$store.commit("actions/setShowSort",!1),document.getElementsByTagName("body")[0].classList.remove("nonscroll"),t===this.sort.current.order?this.$store.commit("actions/setSort",{order:t,by:this.sort.current.by===this.sort.by.desc?this.sort.by.asc:this.sort.by.desc,name:e}):this.$store.commit("actions/setSort",{order:t,by:this.sort.by.desc,name:e}),this.$store.dispatch("actions/initialCouponState"),this.$store.dispatch("actions/getCouponList",{currentSection:this.$route.params.sid,reload:!0,isSearch:"/search"===this.$route.path,favorites:this.favorites}).then((function(){s.isReSort=!1}))},hideSort:function(){this.$store.commit("actions/setShowSort",!1)}}},u=l,p=s("2877"),d=Object(p["a"])(u,i,o,!1,null,null,null);e["a"]=d.exports},"555f":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"preloader"},[s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div"),s("div")])}],a={name:"Loader"},n=a,r=s("2877"),c=Object(r["a"])(n,i,o,!1,null,null,null);e["a"]=c.exports},"70c6":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"geoCatalogContainer",staticClass:"geo-catalog-container"},[s("transition",{attrs:{name:"slide"}},[t.showMap?s("div",{staticClass:"geo-catalog",attrs:{"data-direction":"bottom"}},[s("div",{staticClass:"geo-catalog__content",staticStyle:{"max-height":"502px",overflow:"hidden"}},[s("yandex-map",{staticStyle:{width:"100%",height:"430px"},attrs:{coords:t.coords,clusterOptions:t.claster,viewAllMarkers:t.viewAllMarkers,zoom:t.zoom,controls:["zoomControl"],placemarks:t.placemarks,"map-type":"map"},on:{"map-was-initialized":t.initHandler}},t._l(t.markers,(function(e){return s("ymap-marker",{key:e.id,attrs:{"marker-id":e.id,"marker-type":e.type,"cluster-name":"all",coords:e.coords,"hint-content":e.hint,balloon:e.balloon,icon:t.map.placemark.icon,balloonTemplate:t.balloonTemplate,options:{balloonShadow:t.map.placemark.balloonShadow,closeButton:t.map.placemark.closeButton,hideIconOnBalloonOpen:t.map.placemark.hideIconOnBalloonOpen},properties:{coupon:e.coupon}}})})),1)],1),s("span",{staticClass:"geo-catalog__close",on:{click:t.toggleMap}},[s("i",{staticClass:"i i-close"})]),s("div",{staticClass:"geo-catalog__warning"},[s("span",{staticClass:"icon"},[s("span",{staticClass:"i i-info"})]),s("span",{staticClass:"t"},[t._v("На карте показаны только купоны, по которым для получения скидки нужно куда-то ехать. "),t.countOther?s("span",[t._v("Помимо них в этой категории есть ещё "+t._s(t.countOther)+" шт.")]):t._e()])])]):t._e()])],1)},o=[],a={name:"CatalogMap",props:{coords:{default:function(){return[56.185272,43.547612]}},viewAllMarkers:{type:Boolean,default:!1},countOther:{default:0},placemarks:{default:function(){return[]}},markers:{default:function(){return[]}}},data:function(){return{map:{init:!1,placemark:{icon:{layout:"default#image",imageHref:s("1b20"),imageSize:[30,30],imageOffset:[-12,5],contentOffset:[0,0],contentTemplate:'<div style="color: #FFFFFF;position:relative;top:-2px;font-weight: bold;">$[properties.geoObjects.length]</div>'},balloonShadow:!1,closeButton:!0,hideIconOnBalloonOpen:!1}},claster:{all:{clusterIcons:[{href:s("1b20"),size:[60,60],offset:[-20,-20]},{href:s("1b20"),size:[60,60],offset:[-30,-30]}],clusterNumbers:[100]}},zoom:10}},computed:{showMap:function(){return this.$store.state.actions.showMap},balloonTemplate:function(){return'\n              <span onclick="window.app.$store.dispatch(\'actions/goCoupon\',{id:\'{{ properties.coupon.id }}\'})" class="yamap_baloon_link hover" style="background-image: url({{properties.coupon.image}});">\n                <b>{{ properties.coupon.name }}</b>\n              </span>\n            '}},methods:{toggleMap:function(){this.$store.commit("actions/toggleMap")},initHandler:function(){this.map.init=!0,this.setTemplateClaster()},setTemplateClaster:function(){var t=ymaps.templateLayoutFactory.createClass('<div style="color: #FFFFFF;position:relative;top:-4px;font-weight: bold;">$[properties.geoObjects.length]</div>');this.claster.all.clusterIconContentLayout=t}},watch:{showMap:function(){var t=this.$refs.geoCatalogContainer;1==this.showMap?t.classList.add("active"):t.classList.remove("active")}}},n=a,r=(s("df60"),s("2877")),c=Object(r["a"])(n,i,o,!1,null,null,null);e["a"]=c.exports},9503:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("popup-info-block",{attrs:{show:t.popups.averageCheck.show,"is-set-blank":t.isBanned,"add-class":"",title:"","modal-type":"",text:"",btntext:"Понятно",name:t.popups.averageCheck.name}},[i("div",{staticClass:"modal-txt"},[i("svg",{staticClass:"icon-certif"},[i("use",{attrs:{"xlink:href":s("973d")+"#certif"}})]),i("p",{staticClass:"txt",staticStyle:{"font-size":"12px","line-height":"15px"}},[t._v("\n                При обращении к этому поставщику"),i("br"),t._v("средний чек составляет "),i("strong",[t._v(t._s(t.popupData.averageCheckFormat)+"\n                Р")]),t._v(","),i("br"),t._v("а экономия – около "),i("strong",[t._v(t._s(t.popupData.realSavingsFormat)+" Р")])])])]),t.isEmptyLoad&&t.init?t._e():i("div",{staticClass:"coupon-list-block coupon-list-main",attrs:{id:"catalog-list"}},[i("div",{staticClass:"coupon-list-inner inner"},[t.$route.params.sid&&t.breadcrumbs.length>0?i("div",{staticClass:"breadcrumbs"},t._l(t.breadcrumbs,(function(e,s){return i("span",[s>0?i("span",[t._v("/ ")]):t._e(),i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(s){return t.activeSection(e.id)}}},[t._v(t._s(e.name)+" ")])])})),0):t._e(),i("div",{staticClass:"list-name",class:{solo:t.favorites}},["home"===t.$route.name?i("span",[i("span",{staticClass:"txt"},[t._v("Все скидки ")]),i("a",{staticClass:"choose-city",on:{click:function(e){return t.showPopup("citySelect")}}},[t._v("г. "+t._s(t.currentCity.name))])]):i("span",[t.title?i("span",{staticClass:"txt"},[t._v(t._s(t.title))]):i("span",{staticClass:"txt"},[t._v(" ")])]),t.favorites?t._e():i("div",{staticClass:"sort",on:{click:function(e){return t.showSort()}}},[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":s("973d")+"#sort"}})])])]),i("div",{staticClass:"coupon-list"},[t._l(t.coupons,(function(e){return!(t.favorites&&e.favorite||!t.favorites)||t.visited&&+e.id===+t.$route.params.id?t._e():i("catalog-list-item",{key:e.id,attrs:{item:e},on:{popup:function(s){return t.showInfo(e)}}})})),t.loadAction||!t.init?i("div",{staticClass:"ghost-coupon"},[i("div",{staticClass:"top"}),i("div",{staticClass:"ghost-flag"},[i("svg",{staticClass:"icon"},[i("use",{attrs:{"xlink:href":s("973d")+"#ghost"}})])]),t._m(0)]):t._e()],2),t._e()],1)]),t.isEmptyLoad&&!t.favorites?i("div",{staticClass:"nothing-found"},[t._m(1),i("router-link",{staticClass:"link",attrs:{to:"/catalog"}},[t._v("смотреть все скидки г. "+t._s(t.currentCity.name))])],1):t._e(),t.isEmptyLoad&&t.favorites?i("div",{staticClass:"no-favourites"},[t._m(2),i("svg",{staticClass:"icon-fav fav"},[i("use",{attrs:{"xlink:href":s("973d")+"#no-fav"}})]),i("div",{staticClass:"nofav"},[t._v("У вас нет избранных купонов")]),i("div",{staticClass:"addthem"},[t._v("Чтобы они были – добавьте их...")]),i("div",{staticClass:"button-block icon-big"},[i("button",{staticClass:"btn",on:{click:function(e){return t.goHome()}}},[i("svg",{staticClass:"icon long-ticket"},[i("use",{attrs:{"xlink:href":s("973d")+"#long-ticket"}})]),i("div",{staticClass:"txt"},[t._v("Смотреть все скидки")])])])]):t._e(),i("div",{staticClass:"search-inpt-bg",class:{fadeIn:t.isShowSort},on:{click:t.hideSort}}),i("catalog-sort")],1)},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"elements"},[s("div",{}),s("div",{}),s("div",{})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"txt"},[t._v("К сожалению, по вашему запросу"),s("br"),t._v("ничего не найдено...")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"list-name solo"},[s("span",[s("span",{staticClass:"txt"},[t._v("Избранное")])])])}],a=(s("8e6e"),s("456d"),s("55dd"),s("7f7f"),s("28a5"),s("ac4d"),s("8a81"),s("ac6a"),s("bd86")),n=s("2f62"),r=s("8472"),c=s("c897"),l=s("70c6"),u=s("3343"),p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-title main-title--white"},[s("div",{staticClass:"main-title__wrap"},[s("h1",[t._v(t._s(t.title))])]),t._e(),"favorites"===t.$route.name&&t.showMap?s("div",{staticClass:"sort__right"}):t._e()],1)},d=[],m=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},f=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-title__right"},[s("a",{staticClass:"link-white-trans link-icon",attrs:{href:""}},[s("span",{staticClass:"i i-man"}),s("span",{staticClass:"text"},[t._v("Кабинет партнёра")])])])}],h={name:"MainTitleRight"},v=h,g=s("2877"),b=Object(g["a"])(v,m,f,!1,null,null,null),C=b.exports,_={name:"MainTitle",props:{title:{default:function(){return""}},showMap:{default:!0}},components:{MainTitleRight:C},methods:{toggleMap:function(){this.$store.commit("actions/toggleMap")}}},y=_,w=Object(g["a"])(y,p,d,!1,null,null,null),O=w.exports,k=s("555f"),S=s("f2c8");function $(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function j(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?$(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):$(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var x={name:"CatalogList",components:{PopupInfoBlock:r["a"],CatalogListItem:c["a"],CatalogMap:l["a"],CatalogSort:u["a"],MainTitle:O,Loader:k["a"]},props:{favorites:{default:function(){return!1}},visited:{default:function(){return!1}}},created:function(){var t=this;this.init=!1,(this.favorites&&0===this.favoritesItems.length||this.visited&&0===this.visitedItems.length)&&(this.favorites||this.visited)?(this.$store.commit("actions/isLoadNextPage",!1),this.$nextTick((function(){this.init=!0}))):this.$store.dispatch("actions/getCouponList",{currentSection:this.currentSection,favorites:this.favorites,visited:this.visited,reload:!0}).then((function(e){t.$nextTick((function(){this.init=!0}))}))},mounted:function(){window.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){this.init=!1,window.removeEventListener("scroll",this.handleScroll)},watch:{loadAction:function(t,e){var s=this;0==this.loadAction&&this.$store.state.actions.scrollToCoupon?setTimeout((function(){Object(S["a"])("#id"+s.$store.state.actions.couponId,!0,-30),s.$store.commit("actions/cancelCouponToScroll")}),200):0==this.loadAction&&this.$store.state.actions.scrollToCatalogList&&setTimeout((function(){Object(S["a"])("#catalog-list",!0,-50),s.$store.commit("actions/scrollToCatalogList",!1)}),200)}},computed:j({currentSort:function(){return this.$store.getters["actions/getCurrentSort"]},title:function(){return this.favorites?"Избранное":this.$store.getters["actions/getTitle"](this.currentSection)},isEmptyLoad:function(){return!this.loadAction&&!(this.coupons.length>0)&&this.init},currentSection:function(){return this.$route.params.sid},markers:function(){var t=[],e=!0,s=!1,i=void 0;try{for(var o,a=this.coupons[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var n=o.value;if(n.address.length>0)for(var r in n.address)if(n.address[r].coords){var c=n.address[r].coords.split(",");t.push({id:n.id+"-"+r,type:"placemark",coords:[c[1],c[0]],coupon:{image:"//api.zemskidki.ru"+n.image,name:n.name,id:n.id}})}}}catch(l){s=!0,i=l}finally{try{e||null==a.return||a.return()}finally{if(s)throw i}}return t}},Object(n["b"])({loadAction:function(t){return t.actions.isLoad},breadcrumbs:function(t){return t.actions.breadcrumbs},currentCity:function(t){return t.cities.current},isShowSort:function(t){return t.actions.sort.show},favoritesItems:function(t){return t.actions.favorites.items},visitedItems:function(t){return t.actions.visited.items},sort:function(t){return t.actions.sort},popups:function(t){return t.popups.items},isBanned:function(t){return t.auth.isBanned}}),{coupons:function(){return this.favorites?this.$store.getters["actions/getFavorites"]():this.$store.state.actions.coupons},isIndexPage:function(){return"/"===this.$route.path},currentSortName:function(){return this.sort.order[this.sort.current.order].name}}),data:function(){return{coords:[],init:!1,popupData:{}}},methods:{showInfo:function(t){this.$set(this,"popupData",{averageCheckFormat:t.averageCheckFormat,realSavingsFormat:t.realSavingsFormat}),console.log(t),this.$store.commit("popups/open",{name:this.popups.averageCheck.name})},goHome:function(){this.$router.push("/"),this.$store.commit("actions/scrollToCatalogList",!0)},handleScroll:function(){var t=document,e=window.scrollY,s=window.innerHeight,i=Math.max(t.body.scrollHeight,t.documentElement.scrollHeight,t.body.offsetHeight,t.documentElement.offsetHeight,t.body.clientHeight,t.documentElement.clientHeight);i-s-80<=e&&this.$store.dispatch("actions/getCouponList",{currentSection:this.currentSection,favorites:this.favorites,visited:this.visited})},showPopup:function(t){this.$store.commit("popups/open",{name:t})},showSort:function(){this.$store.commit("actions/setShowSort",!0),document.getElementsByTagName("body")[0].classList.add("nonscroll")},hideSort:function(){this.$store.commit("actions/setShowSort",!1),document.getElementsByTagName("body")[0].classList.remove("nonscroll")},activeSection:function(t){t&&(this.$store.commit("actions/setCouponList",{items:[]}),this.$store.commit("actions/setPage",0),this.$store.commit("actions/previousSection",t),this.$store.commit("actions/setViewType","list"),this.$router.push("/sid"+t))}}},P=x,E=Object(g["a"])(P,i,o,!1,null,null,null);e["a"]=E.exports},c897:function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"coupon",attrs:{id:"id"+t.item.id}},[i("router-link",{staticClass:"coupon-href",attrs:{to:{name:"catalogDetail",params:{id:t.item.id}}},nativeOn:{click:function(e){return t.activeItem(t.item.id)}}}),i("div",{staticClass:"coupon-img",style:{backgroundImage:"url(//api.zemskidki.ru/"+(t.item.image_mobile?t.item.image_mobile:t.item.image)+")"}},[i("div",{staticClass:"coupon-stat"},[i("div",{staticClass:"views stat-item"},[i("svg",{staticClass:"icon-views"},[i("use",{attrs:{"xlink:href":s("973d")+"#views"}})]),i("span",{staticClass:"count"},[t._v(t._s(t.item.showCounterFormat))])]),t.item.statistics.sold>0?i("div",{staticClass:"purchases stat-item"},[i("svg",{staticClass:"icon-cart"},[i("use",{attrs:{"xlink:href":s("973d")+"#cart"}})]),i("span",{staticClass:"count"},[t._v(t._s(t.item.statistics.sold))])]):t._e()])]),i("div",{staticClass:"discount-flag",on:{click:function(e){return t.openAverageCheck()}}},[i("span",{staticClass:"percent"},[t._v("−"+t._s(t.item.discountFrom)+"%")]),i("span",{staticClass:"text-size-s text-normal sum"},[t._v("≈"+t._s(t.item.realSavingsFormat)+" Р")])]),i("div",{ref:"favoriteBtn",staticClass:"c-favourite",on:{click:function(e){return t.setFavorite(t.item)}}},[i("svg",{class:{"icon-fav":!0,fav:!0,active:t.item.favorite}},[i("use",{attrs:{"xlink:href":s("973d")+"#fav"}})])]),i("div",{staticClass:"coupon-name"},[t._v(t._s(t.item.name))]),i("div",{staticClass:"top"},[i("div",{staticClass:"company"},[t._v(t._s(t.item.provider.name))])])],1)},o=[],a=(s("8e6e"),s("ac6a"),s("456d"),s("bd86")),n=(s("f2c8"),s("1f24")),r=s("8472"),c=s("2f62");function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(Object(s),!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var p={name:"CatalogListItem",components:{Tooltip:n["a"],PopupInfoBlock:r["a"]},data:function(){return{popupStatItems:{}}},props:{item:{default:function(){return{}}},isModerator:{default:function(){return!1}},isSimilar:{default:function(){return!1}}},computed:u({},Object(c["b"])({popups:function(t){return t.popups.items},user:function(t){return t.users.user}})),methods:{openAverageCheck:function(){this.$emit("popup")},activeItem:function(t){t&&this.$store.dispatch("actions/goCoupon",{id:t})},setFavorite:function(t){var e=u({},t);this.isSimilar&&(e.isSimilar=!0),this.$store.dispatch("actions/setFavorite",e)}}},d=p,m=s("2877"),f=Object(m["a"])(d,i,o,!1,null,null,null);e["a"]=f.exports},df60:function(t,e,s){"use strict";var i=s("234b"),o=s.n(i);o.a}}]);
//# sourceMappingURL=catalog~home.1958651e.js.map